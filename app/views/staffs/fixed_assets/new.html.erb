<div class="container row mx-auto mt-5 mb-5">
  <div class="text-center col-md-6 mx-auto">
   <h2 class="mb-5">資産登録申請</h2>
   <%= render 'errors/error', model: @fixed_asset %>
   <%= form_with model: @fixed_asset, url: staffs_fixed_assets_path do |f| %>
     <div class="field row mb-4">
      　<span class="col-md-3"><%= f.label :base_name %></span>
      　<span class="col-md-5"><%= f.collection_select(:name, @bases, :id, :name, {:prompt => '選択して下さい'} ) %></span>
     </div>
     <div class="field row mb-4">
       <span class="col-md-2"><%= f.label :name %></span>
       <span class="col-md-7"><%= f.text_field :name %></span>
     <div class="field row mb-4">
      　<span class="col-md-4"><%= f.label :classification %></span>
      　<span class="col-md-2" id="classification_select_id"><%= f.select :classification, options_for_select(ClassificationDetail.classifications), {:include_blank => true}, { :onchange => "changeDetail()"} %></span>
      　<span class="col-md-4 ml-3" id="detail_select_id"><%= render 'classification_detail', f: f, detail_list: [] %></span>
     </div>
     <div class="field row mb-4">
       <span class="col-md-5"><%= f.label :acquisition_date %></span>
       <span class="col-md-7"><%= f.date_field :acquisition_date %></span>
     </div>
     <div class="field row mb-4">
       <span class="col-md-4"><%= f.label :useful_life %></span>
       <%= render 'useful_life', f: f,  %>
     </div>
     <div class="field row mb-4">
       <span class="col-md-5"><%= f.label :cost %></span>
       <span class="col-md-7"><%= f.text_field :cost %>円</span>
     </div>
     <div class="field row mb-5">
       <span class="col-md-5"><%= f.label :month_cost %></span>
       <span class="col-md-7"><%= f.text_field :cost %>円</span>
     </div>
     <div class="field row mb-5">
       <span class="col-md-5"><%= f.label :memo %></span>
       <span class="col-md-6"><%= f.text_area :memo, size: "50x7" %></span>
     </div>
     <div class="field row mb-5">
       <%= f.fields_for :post_images do |i| %>
         <span class="col-md-6"><%= i.attachment_field :image %></span>
       <% end %>
     </div>

     <div class="ax-auto d-block">
       <%= f.submit "申請", class: "btn btn-success" %>
     </div>
   <% end %>
  </div>
</div>

<script>
  function changeDetail(){
    var classification = $('#classification_select_id select option:selected').val();

    console.log(classification)
    $.ajax({
      url: "/staffs/fixed_assets/get_detail/" + classification + "/",
      type: "GET",
      data: {
        classification: classification
      }
    })
  }
</script>

<script>
  function changeUsefulLife(){
    var detail = $('#detail_select_id select option:selected').val();

    console.log(detail)
    $.ajax({
      url: "/staffs/fixed_assets/get_useful_life/" + detail + "/",
      type: "GET",
      data: {
        detail: detail
      }
    })
  }
</script>